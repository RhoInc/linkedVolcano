<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Volcano Upload</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<!-- JS libraries -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
</head>

<body>
  <div>
    <form id="upform"> 
    <h3>Upload</h3>
    Code: <input id="upcode" type="text">
    <br>
    Name: <input id="upname" type="text">
    <br>
    File: <input id="upload" type="file" class="file">
    <br>
    <input type="submit" value="Up We Go">
    </form>
  </div>

</body>

<script>
$("#upform").submit(function(e) {
  e.preventDefault();

  var ff = $('#upload')[0];
  if (!ff.files || !ff.files.length) {
    alert('no file specified');
    return;
  }

  var upfile = ff.files[0];

  var formData = new FormData();
  formData.append('code', $('#upcode').val());
  formData.append('name', $('#upname').val());
  formData.append('upfile', upfile, upfile.name);

  $.ajax({
    url: '/api/datasets',
    method: "POST",
    dataType: 'json',
    data: formData,
    processData: false,
    contentType: false,
    success: function(result) { alert('result: ' + JSON.stringify(result)) },
    error: function(err) { alert('err: ' + JSON.stringify(err)) }
  });
});
</script>
</html>
